---
title: 'HAS: Qualtrics Demographic'
author: "Shuying Yu"
date: "3/30/2022"
output: 
  html_document:
    toc: true
    toc_float: true
    toc_depth: 5
    theme: flatly
---

```{r setup, include=FALSE, warning = FALSE, message = FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE,
                      fig.align = "center")

#Attach packages
library(tidyverse)
library(here)
library(janitor)
library(kableExtra)
library(patchwork)
```


```{r clean_data}
#Read data and clean variable names
data <- read_csv(here("data", "HAS_demo_clean.csv")) %>% 
  clean_names()

#Select certain columns just for review
data_sub <- data %>% 
  select(subject_id, sex, reproductive_status, age_scan_years,
        bmi, self_ses, education_years, verbal_iq,
        
        #Women's basic repro health
        age_at_menarche_years, time_since_last_cycle_years,
        menopausal_status,
        
        #TH and IP qualtrics
        edinburgh_handedness:stai_trait, lca_total, ltpa_total,
        
        #Facename
        fname_nt, fname_ot, fname_t)

#Remove men from repo
data_sub_repo <- data_sub %>% 
  filter(reproductive_status != "Men") %>% 
  mutate(reproductive_status = fct_relevel(reproductive_status, 
                                         c("Pre", "Peri", "Post")))
```

# Introduction

Data of the *cleaned* sample of Healthy Aging Participants, meaning that these are participants that we have decided to include based on complete fMRI scans, no major health problems from demographic survey, and from previous team discussions of who to exclude as we wrapped up recruitment for the study.

Please refer to hand out for means and standard deviations of the basic demographic and neurpsychological batteries. Figures will only include basic demographic and neurpsychological batteries.


# Basic Demographics {.tabset}

Age (years), BMI, highest completed level of education (years), and verbal IQ

**Age:** Ranges from 43-60 years old

**BMI:** Healthy adult BMI levels are about 19-25

**Education:**

- Some College or Associate's = 14 years

- Bachelor's = 16 years

- Master's = 18 years

- Doctoral = 20 years

**Verbal IQ:** Ranges from 74-132 based on AMNART scores


## Reproductive Status


```{r}
#Age
p1 <- ggplot(data = data_sub_repo, aes(y = age_scan_years,
                                 x = reproductive_status,
                                 fill = reproductive_status,
                                 color = reproductive_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Age (years)",
       title = "Age")


#BMI
p2 <- ggplot(data = data_sub_repo, aes(y = bmi,
                                 x = reproductive_status,
                                 fill = reproductive_status,
                                 color = reproductive_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "BMI",
       title = "BMI")


#Education
p3 <- ggplot(data = data_sub_repo, aes(y = education_years,
                                 x = reproductive_status,
                                 fill = reproductive_status,
                                 color = reproductive_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Education (years)",
       title = "Education")


#Verbal IQ
p4 <- ggplot(data = data_sub_repo, aes(y = verbal_iq,
                                 x = reproductive_status,
                                 fill = reproductive_status,
                                 color = reproductive_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Verbal IQ",
       title = "Verbal IQ")

#Combine
(p1+p2)/(p3+p4)
```


## Sex

```{r}
#Age
p1 <- ggplot(data = data_sub, aes(y = age_scan_years,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Age (years)",
       title = "Age")


#BMI
p2 <- ggplot(data = data_sub, aes(y = bmi,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "BMI",
       title = "BMI")


#Education
p3 <- ggplot(data = data_sub, aes(y = education_years,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Education (years)",
       title = "Education")


#Verbal IQ
p4 <- ggplot(data = data_sub, aes(y = verbal_iq,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Verbal IQ",
       title = "Verbal IQ")

#Combine
(p1+p2)/(p3+p4)
```


## Total

```{r}
#Age
p1 <- ggplot(data = data_sub, aes(x = age_scan_years)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Age (years)",
       y = "Count",
       title = "Age")


#BMI
p2 <- ggplot(data = data_sub, aes(x = bmi)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "BMI",
       y = "Count",
       title = "BMI")


#Education
p3 <- ggplot(data = data_sub, aes(x = education_years)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Education (years)",
       y = "Count",
       title = "Education")


#Verbal IQ
p4 <- ggplot(data = data_sub, aes(x = verbal_iq)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Verbal IQ",
       y = "Count",
       title = "Verbal IQ")

#Combine
(p1 + p2)/(p3 + p4)
```


#  {-}


# Reproductive Health Characteristics {.tabset}

Women only. Includes only age at menarche (years) and time since last menstrual cycle (years).

## Reproductive Status

```{r}
#Age at menarche
p1 <- ggplot(data = data_sub_repo, aes(y = age_at_menarche_years,
                                 x = reproductive_status,
                                 fill = reproductive_status,
                                 color = reproductive_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Age (years)",
       title = "Age at Menarche")


#Time since last cycle 
p2 <- ggplot(data = data_sub_repo, aes(y = time_since_last_cycle_years,
                                 x = reproductive_status,
                                 fill = reproductive_status,
                                 color = reproductive_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Time (years)",
       title = "Time Since Last Menstrual Cycle")


#Combine
(p1+p2)
```


## Total

```{r}
#Age at menarche
p1 <- ggplot(data = data_sub, aes(x = age_at_menarche_years)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Age (years)",
       y = "Count",
       title = "Age at Menarche")


#Time since last cycle 
p2 <- ggplot(data = data_sub, aes(x = time_since_last_cycle_years)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Time (years)",
       y = "Count",
       title = "Time Since Last Menstrual Cycle")


#Combine
(p1+p2)
```


#  {-}


# Neuropsychiatric Assessments {.tabset}


## Edinburgh Handedness 

Meaures handedness (most are right handed)

-	Score of -1.0		= Pure Left Hander

-	Score of -0.5		= Mixed Left Hander

-	Score of 0.0		= Neutral

-	Score of +0.5		= Mixed Right Hander

-	Score of +1.0		= Pure Right Hander

```{r}
#Reproductive status
p1 <- ggplot(data = data_sub_repo, aes(y = edinburgh_handedness,
                                 x = reproductive_status,
                                 fill = reproductive_status,
                                 color = reproductive_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Handedness",
       title = "Reproductive Status") + 
  theme(legend.position = "none")


#Sex
p2 <- ggplot(data = data_sub, aes(y = edinburgh_handedness,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Handedness",
       title = "Sex") + 
  theme(legend.position = "none")


#Total
p3 <- ggplot(data = data_sub, aes(x = edinburgh_handedness)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Handedness",
       y = "Count",
       title = "Total")

#Combine
(p1+p2)/p3
```



## Epworth Sleepiness

Measures whether participant is abnormally sleepy

-	Score of 0-7 = Unlikely to be abnormally sleepy

-	Score of 8-9 = Average amount of daytime sleepiness

-	Score of 10-15 = May be excessively sleepy depending on situation 

-	Score of 16-24 = Excessively sleepy 


```{r}
#Reproductive status
p1 <- ggplot(data = data_sub_repo, aes(y = epworth_sleepiness,
                                 x = reproductive_status,
                                 fill = reproductive_status,
                                 color = reproductive_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Sleepiness",
       title = "Reproductive Status") + 
  theme(legend.position = "none")


#Sex
p2 <- ggplot(data = data_sub, aes(y = epworth_sleepiness,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Sleepiness",
       title = "Sex") + 
  theme(legend.position = "none")


#Total
p3 <- ggplot(data = data_sub, aes(x = epworth_sleepiness)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Sleepiness",
       y = "Count",
       title = "Total")

#Combine
(p1+p2)/p3
```


## Barratt

Measures personality and behavior impulsivity. Higher scores indicate more impulsivity.

**Overall/Total**

```{r}
#Reproductive status
p1 <- ggplot(data = data_sub_repo, aes(y = barratt_total,
                                 x = reproductive_status,
                                 fill = reproductive_status,
                                 color = reproductive_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Barratt Total",
       title = "Reproductive Status") + 
  theme(legend.position = "none")


#Sex
p2 <- ggplot(data = data_sub, aes(y = barratt_total,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Barratt Total",
       title = "Sex") + 
  theme(legend.position = "none")


#Total
p3 <- ggplot(data = data_sub, aes(x = barratt_total)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Barratt Total",
       y = "Count",
       title = "Total")

#Combine
(p1+p2)/p3
```

Barratt questionnaire also breaks down the composite/total score into sub-components. Specific questions are categorized into one of these components:

- **Attention:** attention and cognitive instability

- **Motor:** motor and perseverance

- **Non-Planning:** self-control and cognitive complexity


```{r}
#Average barratt scores 
data_sub_barratt <- data_sub %>% 
  select(sex, reproductive_status, barratt_attention:barratt_total) %>% 
  pivot_longer(cols = c("barratt_attention",
                        "barratt_motor",
                        "barratt_non_planning",
                        "barratt_total"),
               names_to = "barratt_type",
               values_to = "score") %>% 
  mutate(barratt_type = recode(barratt_type,
                               barratt_attention = "Attention",
                               barratt_motor = "Motor",
                               barratt_non_planning = "Non-Planning",
                               barratt_total = "Total"))

#Mean by sex
data_sub_barratt_mean <- data_sub_barratt %>% 
  group_by(sex, barratt_type) %>% 
  mutate(mean_score = mean(score))


#Mean by repo status
data_sub_barratt_mean_repo <- data_sub_barratt_mean %>% 
  filter(reproductive_status != "Men") %>% 
  mutate(reproductive_status = fct_relevel(reproductive_status, 
                                         c("Pre", "Peri", "Post"))) %>% 
  group_by(reproductive_status, barratt_type) %>% 
  mutate(mean_score = mean(score))
```


```{r barratt-types}
#Reproductive status
p1 <- ggplot(data = data_sub_barratt_mean_repo, aes(y = mean_score,
                                              x = reproductive_status,
                                              group = barratt_type)) + 
  geom_line(aes(color = barratt_type), size = 0.8,
            show.legend = FALSE) +
  geom_point(aes(color = barratt_type), size = 2,
             show.legend = FALSE) +
  labs(x = "Reproductive Status",
       y = "Barratt Score",
       title = "Reproductive Status") 


#Sex
#Repoductive status
p2 <- ggplot(data = data_sub_barratt_mean, aes(y = mean_score,
                                         x = sex,
                                         group = barratt_type)) + 
  geom_line(aes(color = barratt_type), size = 0.8) +
  geom_point(aes(color = barratt_type), size = 2) +
  labs(x = "Sex",
       y = "Barratt Score",
       title = "Sex") 


#Total
p3 <- ggplot(data = data_sub_barratt, 
       aes(x = score,
           fill = barratt_type,
           color = barratt_type)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Barratt Score",
       y = "Count",
       title = "Total")


#Combine
(p1+p2)/p3
```


## Medical Outcomes

General health index of participants. Scores are the weighted sums of the questions in each section

- Lower scores = more disability

- Higher scores = less disability 

```{r}
#Reproductive status
p1 <- ggplot(data = data_sub_repo, aes(y = medical_outcomes,
                                 x = reproductive_status,
                                 fill = reproductive_status,
                                 color = reproductive_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Medical Outcome",
       title = "Reproductive Status") + 
  theme(legend.position = "none")


#Sex
p2 <- ggplot(data = data_sub, aes(y = medical_outcomes,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Medical Outcome",
       title = "Sex") + 
  theme(legend.position = "none")


#Total
p3 <- ggplot(data = data_sub, aes(x = medical_outcomes)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Medical Outcome",
       y = "Count",
       title = "Total")

#Combine
(p1+p2)/p3
```

## BAS Total

## BIS Total

## Perceived Stress



## SSS Community Ladder

## SSS US Ladder

## Geriatric Depression

## PSQI

## LCA Total

## LTPA Total

## POMS

## STAI

### State

### Trait


# {-}

# Face Name

## Name Learning and Retrieval


## Ocupation Learning and Retrieval


## Composite Name and Occupation












