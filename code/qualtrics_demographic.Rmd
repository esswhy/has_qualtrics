---
title: 'HAS: Qualtrics Demographic'
author: "Shuying Yu"
date: "3/30/2022"
output: 
  html_document:
    toc: true
    toc_float: true
    toc_depth: 5
    theme: flatly
---

```{r setup, include=FALSE, warning = FALSE, message = FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE,
                      fig.align = "center")

#Attach packages
library(tidyverse)
library(here)
library(janitor)
library(kableExtra)
library(patchwork)
```


```{r clean_data}
#Read data and clean variable names
data <- read_csv(here("data", "HAS_demo_clean.csv")) %>% 
  clean_names()

#Select certain columns just for review
data_sub <- data %>% 
  select(subject_id, sex, reproductive_status, age_scan_years,
        bmi, self_ses, education_years, verbal_iq,
        
        #Women's basic repro health
        age_at_menarche_years, time_since_last_cycle_years,
        menopausal_status,
        
        #TH and IP qualtrics
        edinburgh_handedness:stai_trait, lca_total, ltpa_total,
        
        #Facename
        fname_nt, fname_ot, fname_t)

#Remove men from repo
data_sub_repo <- data_sub %>% 
  filter(reproductive_status != "Men") %>% 
  mutate(reproductive_status = fct_relevel(reproductive_status, 
                                         c("Pre", "Peri", "Post")))
```

# Introduction

Data of the *cleaned* sample of Healthy Aging Participants, meaning that these are participants that we have decided to include based on complete fMRI scans, no major health problems from demographic survey, and from previous team discussions of who to exclude as we wrapped up recruitment for the study.

Please refer to hand out for means and standard deviations of the basic demographic and neurpsychological batteries. Figures will only include basic demographic and neurpsychological batteries.


# Basic Demographics {.tabset}

Age (years), BMI, highest completed level of education (years), and verbal IQ

**Age:** Ranges from 43-60 years old

**BMI:** Healthy adult BMI levels are about 19-25

**Education:**

- Some College or Associate's = 14 years

- Bachelor's = 16 years

- Master's = 18 years

- Doctoral = 20 years

**Verbal IQ:** Ranges from 74-132 based on AMNART scores


## Reproductive Status


```{r}
#Age
p1 <- ggplot(data = data_sub_repo, aes(y = age_scan_years,
                                 x = reproductive_status,
                                 fill = reproductive_status,
                                 color = reproductive_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Age (years)",
       title = "Age")


#BMI
p2 <- ggplot(data = data_sub_repo, aes(y = bmi,
                                 x = reproductive_status,
                                 fill = reproductive_status,
                                 color = reproductive_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "BMI",
       title = "BMI")


#Education
p3 <- ggplot(data = data_sub_repo, aes(y = education_years,
                                 x = reproductive_status,
                                 fill = reproductive_status,
                                 color = reproductive_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Education (years)",
       title = "Education")


#Verbal IQ
p4 <- ggplot(data = data_sub_repo, aes(y = verbal_iq,
                                 x = reproductive_status,
                                 fill = reproductive_status,
                                 color = reproductive_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Verbal IQ",
       title = "Verbal IQ")

#Combine
(p1+p2)/(p3+p4)
```


## Sex

```{r}
#Age
p1 <- ggplot(data = data_sub, aes(y = age_scan_years,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Age (years)",
       title = "Age")


#BMI
p2 <- ggplot(data = data_sub, aes(y = bmi,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "BMI",
       title = "BMI")


#Education
p3 <- ggplot(data = data_sub, aes(y = education_years,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Education (years)",
       title = "Education")


#Verbal IQ
p4 <- ggplot(data = data_sub, aes(y = verbal_iq,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Verbal IQ",
       title = "Verbal IQ")

#Combine
(p1+p2)/(p3+p4)
```


## Total

```{r}
#Age
p1 <- ggplot(data = data_sub, aes(x = age_scan_years)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Age (years)",
       y = "Count",
       title = "Age")


#BMI
p2 <- ggplot(data = data_sub, aes(x = bmi)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "BMI",
       y = "Count",
       title = "BMI")


#Education
p3 <- ggplot(data = data_sub, aes(x = education_years)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Education (years)",
       y = "Count",
       title = "Education")


#Verbal IQ
p4 <- ggplot(data = data_sub, aes(x = verbal_iq)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Verbal IQ",
       y = "Count",
       title = "Verbal IQ")

#Combine
(p1 + p2)/(p3 + p4)
```


#  {-}


# Reproductive Health Characteristics {.tabset}

Women only. Includes only age at menarche (years) and time since last menstrual cycle (years).

## Reproductive Status

```{r}
#Age at menarche
p1 <- ggplot(data = data_sub_repo, aes(y = age_at_menarche_years,
                                 x = reproductive_status,
                                 fill = reproductive_status,
                                 color = reproductive_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Age (years)",
       title = "Age at Menarche")


#Time since last cycle 
p2 <- ggplot(data = data_sub_repo, aes(y = time_since_last_cycle_years,
                                 x = reproductive_status,
                                 fill = reproductive_status,
                                 color = reproductive_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Time (years)",
       title = "Time Since Last Menstrual Cycle")


#Combine
(p1+p2)
```


## Total

```{r}
#Age at menarche
p1 <- ggplot(data = data_sub, aes(x = age_at_menarche_years)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Age (years)",
       y = "Count",
       title = "Age at Menarche")


#Time since last cycle 
p2 <- ggplot(data = data_sub, aes(x = time_since_last_cycle_years)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Time (years)",
       y = "Count",
       title = "Time Since Last Menstrual Cycle")


#Combine
(p1+p2)
```


#  {-}


# Neuropsychiatric Assessments {.tabset}


## Edinburgh Handedness 

```{r}
#Reproductive status
p1 <- ggplot(data = data_sub_repo, aes(y = edinburgh_handedness,
                                 x = reproductive_status,
                                 fill = reproductive_status,
                                 color = reproductive_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Handedness",
       title = "Reproductive Status") + 
  theme(legend.position = "none")


#Sex
p2 <- ggplot(data = data_sub, aes(y = edinburgh_handedness,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Handedness",
       title = "Sex") + 
  theme(legend.position = "none")


#Total
p3 <- ggplot(data = data_sub, aes(x = edinburgh_handedness)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Handedness",
       y = "Count",
       title = "Total")

#Combine
(p1+p2)/p3
```



## Epworth Sleepiness

```{r}
#Reproductive status
p1 <- ggplot(data = data_sub_repo, aes(y = epworth_sleepiness,
                                 x = reproductive_status,
                                 fill = reproductive_status,
                                 color = reproductive_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Sleepiness",
       title = "Reproductive Status") + 
  theme(legend.position = "none")


#Sex
p2 <- ggplot(data = data_sub, aes(y = epworth_sleepiness,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Sleepiness",
       title = "Sex") + 
  theme(legend.position = "none")


#Total
p3 <- ggplot(data = data_sub, aes(x = epworth_sleepiness)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Sleepiness",
       y = "Count",
       title = "Total")

#Combine
(p1+p2)/p3
```


## Barratt Total

```{r}
#Reproductive status
p1 <- ggplot(data = data_sub_repo, aes(y = barratt_total,
                                 x = reproductive_status,
                                 fill = reproductive_status,
                                 color = reproductive_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Barratt Total",
       title = "Reproductive Status") + 
  theme(legend.position = "none")


#Sex
p2 <- ggplot(data = data_sub, aes(y = barratt_total,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Barratt Total",
       title = "Sex") + 
  theme(legend.position = "none")


#Total
p3 <- ggplot(data = data_sub, aes(x = barratt_total)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Barratt Total",
       y = "Count",
       title = "Total")

#Combine
(p1+p2)/p3
```


## Medical Outcomes

## BAS Total

## BIS Total

## Perceived Stress

## SSS Community Ladder

## SSS US Ladder

## Geriatric Depression

## PSQI

## LCA Total

## LTPA Total

## POMS

## STAI

### State

### Trait


# {-}

# Face Name

## Name Learning and Retrieval


## Ocupation Learning and Retrieval


## Composite Name and Occupation












